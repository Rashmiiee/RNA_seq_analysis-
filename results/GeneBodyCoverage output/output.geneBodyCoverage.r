output_1_Aligned.sortedByCoord.out <- c(0.38285997957998225,0.5802381311845402,0.7053823891420777,0.7807138305957374,0.8353399369998951,0.8821051042367698,0.9156074955283232,0.9236936178488355,0.9377470937299286,0.9444795582315958,0.9499927071365147,0.9792908266012953,1.0,0.9761497775036913,0.9499504852952843,0.9443567310571069,0.9588055569060858,0.979734795659083,0.9847847837602004,0.9659896671639461,0.9489205282592063,0.9489409994549544,0.9560201948346055,0.9484279401115169,0.9265058483647353,0.8881722548766227,0.8631718070692157,0.8504617534090938,0.8618245464990417,0.8711453378131133,0.8972077288999547,0.8941242550403923,0.8639497125076447,0.8645446566340749,0.8703840652212297,0.8856606950482736,0.8700526877400567,0.8648862697131218,0.8803407430532276,0.9073358529963433,0.9052541882787051,0.9372583439314419,0.9422801841384058,0.9470589288958605,0.9309979963817161,0.9121171566532665,0.8585133305867813,0.8431049174371087,0.8522453063386499,0.8468012477193808,0.8627316763606309,0.8506984516099316,0.865070510474855,0.836028280956926,0.8071114375129544,0.8030376695590761,0.831005161300228,0.8389147195574127,0.8357967005550253,0.7998492808213044,0.8050476850915959,0.8195732779246302,0.8169094635779044,0.8372040952627094,0.833130327308831,0.8102819139544465,0.8235408515505651,0.8187326794492225,0.8016379515497974,0.7988154854360237,0.7888127474135923,0.7966084346444281,0.7903711171899189,0.7923683382250961,0.8129738761953259,0.7840199287090608,0.7626940605384436,0.7437057470323163,0.715870038613793,0.7468096920876269,0.7212066234553843,0.6936268049837127,0.6747741131494167,0.6684357191659012,0.6687133597582352,0.6568119183301646,0.644613644563746,0.6285821393934896,0.5694114275332465,0.5387852392443058,0.5117530252588967,0.49558078061787186,0.49164647268502765,0.4700416844723421,0.42535946140283987,0.3476034627027608,0.24147566614550414,0.1817010540106911,0.07334445601635649,0.0)
output_4_Aligned.sortedByCoord.out <- c(0.3461628192534381,0.5174054518664047,0.6394503110674525,0.7235449410609037,0.7739685658153241,0.8126391617550753,0.8584336116568435,0.8714063523248199,0.9016638015717092,0.9068987393582187,0.9101281106745253,0.9355803863785199,0.9619638179436805,0.9603204813359528,0.9470632776686313,0.9464800261951539,0.9682158644400786,0.9878888343156516,1.0,0.9643234282907662,0.9456634741322856,0.94421864767518,0.9307383759004584,0.913791339227243,0.9132490176817288,0.876637197118533,0.8546435003274394,0.8377169286182057,0.8471696954813359,0.8482604780615586,0.8540643418467584,0.8393807301899149,0.8084745415848068,0.8131917157825802,0.8193741814014407,0.8331430091683039,0.8113580550098232,0.8072200392927309,0.8219875573018991,0.8466069089718402,0.8441245088408644,0.8904612802881466,0.8998874426981008,0.9003335789129011,0.8845960216110019,0.8556483300589391,0.8055214472822528,0.7981929436804192,0.8258165520628684,0.824889489194499,0.8421209888670596,0.8315344629993451,0.8381958087753766,0.8129052062868369,0.7815221840209561,0.7914067616240995,0.811527914210871,0.8237700556647021,0.8133697609692206,0.7603818762278979,0.7455018009168304,0.766965455140799,0.7676694499017682,0.7925343811394892,0.7922642436149312,0.7639264079895219,0.779219875573019,0.7632674361493124,0.7460707269155207,0.7340884905042567,0.7150376555337262,0.7339902586771447,0.7313441388343157,0.737217583497053,0.7590864440078585,0.735175180091683,0.7102795514079895,0.690244351669941,0.6687274885396202,0.6963142599869024,0.6770403569089718,0.6518234282907662,0.6363764734774067,0.6284585789129011,0.6194846922069417,0.6113253110674525,0.5952214309102816,0.578235510805501,0.5195685985592665,0.49841601178781925,0.4848313686967911,0.46565774394237064,0.44842215127701374,0.4295841519318926,0.3827521283562541,0.3076784544859201,0.20796291748526521,0.1507715291421087,0.05447159462999345,0.0)
output_3_Aligned.sortedByCoord.out <- c(0.40564541550100475,0.5864346506954569,0.7078785610150125,0.7828273375625517,0.8236657275700382,0.859162595058907,0.895326845029355,0.8988829347097994,0.9264253910713582,0.9293584262579297,0.9330942905551834,0.9594078765908822,0.9778212301509122,0.9758757240237992,0.9567137200047283,0.9537831474841404,0.9758018440442886,0.9991676188975137,1.0,0.955755742937074,0.9306340872374798,0.9269376255959652,0.9107061940974822,0.8955140076441153,0.8886283935537255,0.852043027700067,0.8326544584104969,0.811034713739706,0.8193191221088302,0.8164230269120138,0.8263303321643879,0.8113154576618464,0.7715483273572639,0.7754270262815713,0.7862479806138933,0.8049494660940147,0.7876886402143505,0.7770080578430987,0.7908753299972419,0.8178538358485362,0.8104436739036212,0.8690280349895583,0.883309035028961,0.8828829938137831,0.8718379368769456,0.8365627093266086,0.7879324441467355,0.7824653256629497,0.8207080657236298,0.8187231569407778,0.8433153394538792,0.8313640214350447,0.8396090271484298,0.815681764450924,0.7874670002758186,0.8064492296780803,0.8290171007525907,0.8338931794002916,0.8176839118956618,0.7546421253792506,0.74248640608377,0.7689920800661965,0.7716148193388235,0.7934734426100319,0.7905601087513299,0.7572599393199102,0.7778626029394381,0.7547677213444186,0.7394918042476063,0.730382402773947,0.706637377359234,0.7394129989361283,0.7462764490326648,0.7484854604200323,0.7738607707159463,0.7481997911659246,0.7240533511958706,0.7017243587217779,0.6845792781433468,0.7088857914023405,0.684436443516293,0.6624571496118838,0.6493508412467001,0.6421007525907246,0.6323338192994208,0.6223132314117972,0.6058256826510107,0.5944383151424406,0.532226447062532,0.5056739824264156,0.4931119232436266,0.4716965798494819,0.46239016509712755,0.4476584971827101,0.40500512234524605,0.3272415185783522,0.21366828874266125,0.15991567831671855,0.05787265061665156,0.0)
output_2_Aligned.sortedByCoord.out <- c(0.2816892824269058,0.46410259215212546,0.592766290614212,0.681898379885387,0.7371341771202373,0.7938858527910135,0.8453100752782106,0.862683292362942,0.8898690874880644,0.9056701667310003,0.9082674759686385,0.930189891122422,0.9532062391681109,0.9438781171227064,0.9301852028385996,0.9300945626846988,0.9568865419687353,0.9910172481961828,1.0,0.9734986943129554,0.9543361155693217,0.9545408372962355,0.9541704628742618,0.9416746237261542,0.9328512735723004,0.8899691042096101,0.8752432047232896,0.8600203471517894,0.8729037510958864,0.8749431545586528,0.8934024907289188,0.8775263989448235,0.8443020942563835,0.8441270649936786,0.8528972812642114,0.8642773088625755,0.853236400460702,0.8432519186801544,0.8579121821929604,0.8916225056376613,0.8893846314930778,0.9314416629030166,0.9399258938603798,0.9383381284058429,0.9231840323304052,0.9016148012245797,0.8462602341328941,0.8403967538322813,0.8635193696446125,0.8524534570623526,0.8689593416399304,0.8636584553980119,0.8756354578031015,0.842137669891685,0.8040297362215245,0.8060113175171474,0.8220327460997385,0.8359256938269367,0.8336581272181443,0.7866987136911953,0.7872238014793098,0.8014246131775156,0.7971879673632936,0.8149596885729333,0.8143674020500302,0.7888193807402175,0.8045251315454303,0.7970770113128288,0.7796584741511472,0.7728229563380128,0.7561936136197771,0.7738293745985657,0.7730823747095218,0.7763594851014154,0.798281900255199,0.7744622929145967,0.7511224532851586,0.7330444308657854,0.6998310655062643,0.7245133170701977,0.701353194987287,0.679955867621618,0.6672709343593382,0.6645407904133972,0.6633952863994449,0.6555330344291936,0.6380191688297887,0.6214163930532136,0.5580198564447494,0.5282336265594404,0.5045593560173341,0.47911760247416363,0.4659075814237693,0.44863594382185773,0.3972711062630784,0.32249766757879833,0.22575649366378442,0.16477442322388275,0.059697480672549944,0.0)
output_0_Aligned.sortedByCoord.out <- c(0.21566713131455578,0.41492694903517763,0.5508699040149555,0.6426279182870583,0.7068939644589564,0.7846962703419049,0.8453753071286387,0.8557132706691472,0.8836680786900184,0.9035756191839915,0.9096250815845759,0.9417653365442853,0.9741587070856091,0.9563140585817934,0.9256834572695699,0.9239821589674331,0.9459815189466053,0.9839832075891283,1.0,0.9803672707089225,0.9633398239400333,0.9562797071814314,0.9515844131424842,0.9463322648239852,0.9292975861813356,0.8944688821511931,0.8770129468619996,0.8419202794396021,0.8627932750805902,0.8697214101430646,0.8920877877155776,0.8788860021659461,0.826283160401152,0.8306765237106021,0.8418244571122766,0.8584469189505828,0.837208713684694,0.8326743288369158,0.8465233670881042,0.8835758722995731,0.882395268908186,0.9187734018914966,0.9300081177782961,0.9225827913947934,0.9174300813405001,0.887050787641451,0.8309639906925784,0.8367079064267854,0.8499783947771408,0.844903427365772,0.8734422091927964,0.8653352787073749,0.8774034680450618,0.8535925236889065,0.8284726101821167,0.8350102240615288,0.8689602554297812,0.8833914595186826,0.8774830186564263,0.8149562381239073,0.8315262688774505,0.8504285789187264,0.8526578040053733,0.8778554601550875,0.8785641837836079,0.8524137282659594,0.8630626623781655,0.8510957192731243,0.8304704153084304,0.8243341704227211,0.8032532584111212,0.8145223256982826,0.8227521980376311,0.8259269906184518,0.8620538159885881,0.8221230250204753,0.7791693108205103,0.7655661562771761,0.7402636379579358,0.7743655386751569,0.7451216491564924,0.7224750364757633,0.7125854491084004,0.7039831352703907,0.7061870487988762,0.6916835259723706,0.6611306673030716,0.6430853343024044,0.5828420179097353,0.5504811908003334,0.5367297828449107,0.5132496967132941,0.5222678432925275,0.4974534764521151,0.44198138877287757,0.3492506874799993,0.2411649102253271,0.180885434463856,0.06955254589075893,0.0)
output_5_Aligned.sortedByCoord.out <- c(0.35135818421865783,0.5469605887805837,0.6660299446613669,0.7342598574866335,0.7783294474563892,0.8387548339372829,0.8867547777559295,0.8865909154751538,0.911142166914801,0.9279240053559557,0.934185885371312,0.9653314231673175,0.993031171287583,0.9773355056789985,0.94505463636619,0.9452910662284522,0.9605302583405901,0.9916125921140106,1.0,0.9706358792849986,0.9495397810799929,0.9443898236841859,0.9359766660112175,0.9286847945166999,0.9149624989465996,0.8780326226392127,0.8535937339063832,0.8173403747296273,0.8299156343342978,0.8316806651872244,0.8545886120396641,0.8481254155079263,0.7979414215755124,0.800127812579005,0.8032809910390741,0.8201939193048494,0.8010454413513488,0.7949357191681414,0.8106945887993109,0.8501268762231149,0.8479475078887984,0.8982134329616001,0.9144311169789413,0.9054186915362791,0.9055755311478787,0.8692355590512842,0.8233798702210736,0.8257277826156165,0.8521447231663811,0.8425494161821024,0.872597076696911,0.8673932788374206,0.8815720479039674,0.8531606693071903,0.8208283004204238,0.8336399898873564,0.8628589754393851,0.8669555324587769,0.8496282667116117,0.7712342106988024,0.7752301094600036,0.8016681180182964,0.8030047660514809,0.8317368465406332,0.8318492092474508,0.7925761023249717,0.8094234856784367,0.794256861147785,0.774193095311666,0.7670861541054524,0.7497190932329559,0.7814170810041481,0.7930138487036152,0.7958463252713092,0.8293210483440546,0.793994681498544,0.7550282311300879,0.7350463964343568,0.7061551354438795,0.74039532945682,0.7140228658108374,0.6944740957142991,0.6870815659615906,0.680932048653052,0.6802391452943435,0.6619474329803272,0.6406593818178413,0.6218924688895755,0.5568578705394346,0.5289708512411397,0.5222548386190623,0.48980074346657676,0.48981712969465435,0.4699336123673886,0.4223082109048007,0.3367767821193479,0.22218320739346611,0.16788861110330813,0.060324728222702885,0.0)
data_matrix <- matrix(c(output_1_Aligned.sortedByCoord.out,output_4_Aligned.sortedByCoord.out,output_3_Aligned.sortedByCoord.out,output_2_Aligned.sortedByCoord.out,output_0_Aligned.sortedByCoord.out,output_5_Aligned.sortedByCoord.out), byrow=T, ncol=100)
rowLabel <- c("output_1_Aligned.sortedByCoord.out","output_4_Aligned.sortedByCoord.out","output_3_Aligned.sortedByCoord.out","output_2_Aligned.sortedByCoord.out","output_0_Aligned.sortedByCoord.out","output_5_Aligned.sortedByCoord.out")


pdf("output.geneBodyCoverage.heatMap.pdf")
rc <- cm.colors(ncol(data_matrix))
heatmap(data_matrix, scale=c("none"),keep.dendro=F, labRow = rowLabel ,Colv = NA,Rowv = NA,labCol=NA,col=cm.colors(256),margins = c(6, 8),ColSideColors = rc,cexRow=1,cexCol=1,xlab="Gene body percentile (5'->3')", add.expr=x_axis_expr <- axis(side=1,at=c(1,10,20,30,40,50,60,70,80,90,100),labels=c("1","10","20","30","40","50","60","70","80","90","100")))
dev.off()


pdf("output.geneBodyCoverage.curves.pdf")
x=1:100
icolor = colorRampPalette(c("#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"))(6)
plot(x,output_1_Aligned.sortedByCoord.out,type='l',xlab="Gene body percentile (5'->3')", ylab="Coverage",lwd=0.8,col=icolor[1])
lines(x,output_4_Aligned.sortedByCoord.out,type='l',col=icolor[2])
lines(x,output_3_Aligned.sortedByCoord.out,type='l',col=icolor[3])
lines(x,output_2_Aligned.sortedByCoord.out,type='l',col=icolor[4])
lines(x,output_0_Aligned.sortedByCoord.out,type='l',col=icolor[5])
lines(x,output_5_Aligned.sortedByCoord.out,type='l',col=icolor[6])
legend(0,1,fill=icolor[1:6], legend=c('output_1_Aligned.sortedByCoord.out','output_4_Aligned.sortedByCoord.out','output_3_Aligned.sortedByCoord.out','output_2_Aligned.sortedByCoord.out','output_0_Aligned.sortedByCoord.out','output_5_Aligned.sortedByCoord.out'))
dev.off()
